# 自定义任务工作流程规范

## 概述
自定义任务工作流基于基础模板扩展，专门用于灵活多样的AI驱动任务执行。该工作流支持灵活的任务目标、多格式输出、数据预处理、迭代优化等特性，能够适应各种不同类型的分析、报告、优化等任务需求。

## 工作流程

### 1. 自定义任务初始化和目标分析 (init)
- **目的**：分析自定义任务的目标和需求，分解为具体的子目标
- **AI提示词**：使用 `custom_init_prompt` 模板
- **输出**：任务目标表格，包含子目标、实现方式、数据需求等
- **审批要求**：无需人工审批
- **表格格式**：
  | 序号 | 任务子目标 | 实现方式 | 数据需求 | 输出格式 | 质量标准 | 预估时间 | 依赖关系 |
  |------|------------|----------|----------|----------|----------|----------|----------|

### 2. 任务目标选择和优先级设定 (select_objectives)
- **目的**：交互式选择要执行的任务目标并设定优先级
- **执行方式**：支持快捷指令选择和重新排序
- **输出**：确定的目标列表和执行顺序
- **审批要求**：需要人工确认目标选择
- **支持命令**：
  - `继续` - 执行所有目标
  - `默认顺序` - 按重要性顺序执行
  - `选择序号X,Y` - 批量选择特定目标
  - `跳过序号X,Y` - 跳过指定目标
  - `重新排序X,Y,Z` - 重新设定优先级
- **目标类别**：
  - 数据分析
  - 报告生成
  - 流程优化
  - 方案设计
  - 评估分析
  - 知识整理

### 3. 数据源拉取和预处理 (data_source_setup)
- **目的**：收集和预处理任务所需的各种数据源
- **执行方式**：自动化数据采集和标准化处理
- **输出**：结构化的数据集合
- **DoD检查**：数据完整性、质量评分验证
- **预处理步骤**：
  - 数据格式标准化
  - 数据质量检查
  - 数据清洗过滤
  - 数据结构转换
  - 缺失值处理
- **支持格式**：JSON, CSV, Excel, XML, Markdown, Text

### 4. 分析策略制定 (analysis_strategy)
- **目的**：根据选择的目标制定详细的分析策略
- **AI提示词**：使用 `custom_strategy_prompt` 模板
- **输出**：分析策略文档
- **审批要求**：需要人工确认分析策略
- **DoD检查**：策略完整性、可行性验证
- **策略组件**：
  - 分析方法选择
  - 处理流程设计
  - 质量控制方案
  - 输出格式规划
  - 验证机制设定

### 5. 主要分析执行 (primary_analysis)
- **目的**：执行核心的分析任务
- **AI提示词**：使用 `custom_analysis_prompt` 模板
- **输出**：详细的分析结果
- **DoD检查**：分析覆盖率、关键发现识别
- **分析方法**：
  - 定量分析
  - 定性分析
  - 比较分析
  - 趋势分析
  - 关联分析

### 6. 洞察和发现生成 (insight_generation)
- **目的**：从分析结果中提取关键洞察和发现
- **AI提示词**：使用 `custom_insight_prompt` 模板
- **输出**：洞察和发现报告
- **DoD检查**：洞察质量评分、价值评估
- **洞察类型**：
  - 关键发现
  - 模式识别
  - 异常检测
  - 机会识别
  - 风险预警

### 7. 建议和方案生成 (recommendation_generation)
- **目的**：基于洞察生成具体的建议和行动方案
- **AI提示词**：使用 `custom_recommendation_prompt` 模板
- **输出**：建议和方案文档
- **DoD检查**：建议可操作性、实用性评估
- **建议类型**：
  - 改进建议
  - 优化方案
  - 实施计划
  - 风险缓解
  - 后续行动

### 8. 内容结构化和组织 (content_structuring)
- **目的**：将所有分析结果组织成结构化的内容
- **AI提示词**：使用 `custom_structure_prompt` 模板
- **输出**：结构化的内容文档
- **DoD检查**：内容逻辑一致性、完整性验证
- **结构格式**：
  - 执行摘要
  - 详细分析
  - 图表可视化
  - 附录资料
  - 行动清单

### 9. 多格式输出生成 (multi_format_generation)
- **目的**：将内容转换为多种输出格式
- **执行方式**：自动化格式转换和美化
- **输出**：多格式的交付文件
- **DoD检查**：格式转换成功率、视觉效果质量
- **支持格式**：
  - **Markdown**：支持目录生成、图表嵌入、代码高亮
  - **Excel**：支持多工作表、图表生成、数据透视表
  - **PowerPoint**：支持模板应用、图表插入、演示脚本
  - **PDF**：支持专业排版、书签导航、水印添加

### 10. 质量审查和优化 (quality_review)
- **目的**：审查内容质量并进行最终优化
- **AI提示词**：使用 `custom_quality_prompt` 模板
- **输出**：质量审查报告和优化后的内容
- **DoD检查**：质量检查项目覆盖率、内容准确性
- **审查标准**：
  - 内容准确性
  - 逻辑一致性
  - 表达清晰度
  - 实用性价值
  - 完整性检查

### 11. 交付前人工审批 (approval_before_delivery)
- **目的**：在最终交付前进行人工审查
- **执行方式**：暂停等待人工确认
- **输出**：审批状态和意见
- **审批要求**：必须人工审批
- **超时设置**：2小时
- **预览功能**：支持多格式预览

### 12. 打包交付物 (package_deliverables)
- **目的**：将所有产出打包为完整的交付物
- **执行方式**：自动化打包和元数据生成
- **输出**：完整的交付包
- **审批要求**：无需人工审批
- **包含内容**：
  - 主要输出文件
  - 数据源文件
  - 处理日志
  - 质量报告
- **元数据**：
  - 任务描述
  - 创建时间
  - 输出格式
  - 数据来源

### 13. 交付结果 (deliver_results)
- **目的**：将结果交付到指定位置
- **执行方式**：文件系统操作
- **输出**：交付状态确认
- **审批要求**：无需人工审批

### 14. 完成通知 (notify_completion)
- **目的**：通知相关人员任务完成
- **执行方式**：发送完成通知
- **输出**：通知发送状态
- **审批要求**：无需人工审批
- **通知内容**：
  - 任务摘要
  - 交付物信息
  - 下载链接

### 15. 自定义任务完成总结 (finalize)
- **目的**：生成任务执行的完成报告
- **AI提示词**：使用 `custom_finalize_prompt` 模板
- **输出**：完成总结报告

## 任务复杂度级别

### 低复杂度 (low)
- **最大迭代次数**：2次
- **分析深度**：基础
- **输出详细度**：摘要级别
- **AI调用限制**：5次
- **适用场景**：简单数据汇总、基础报告生成

### 中等复杂度 (medium)
- **最大迭代次数**：3次
- **分析深度**：详细
- **输出详细度**：全面
- **AI调用限制**：8次
- **适用场景**：深度分析、方案设计、流程优化

### 高复杂度 (high)
- **最大迭代次数**：5次
- **分析深度**：深度
- **输出详细度**：详尽
- **AI调用限制**：12次
- **适用场景**：复杂研究、战略分析、系统设计

## 输出格式配置

### Markdown格式
- **模板**：`custom_markdown_template`
- **特性**：
  - 目录生成
  - 图表嵌入
  - 代码高亮
  - 链接支持

### Excel格式
- **模板**：`custom_excel_template`
- **特性**：
  - 多工作表（摘要、详细数据、图表、建议）
  - 图表生成
  - 数据透视表
  - 格式美化

### PowerPoint格式
- **模板**：`custom_ppt_template`
- **特性**：
  - 标准幻灯片类型（标题页、摘要页、分析页、图表页、建议页）
  - 图表插入
  - 动画效果
  - 演示脚本

### PDF格式
- **模板**：`custom_pdf_template`
- **特性**：
  - 专业排版
  - 书签导航
  - 页眉页脚
  - 水印添加

## DoD验证规则

### 数据预处理验证
- 数据完整性 ≥ 95%
- 数据质量评分 ≥ 8.0
- 格式标准化率 = 100%

### 分析执行验证
- 分析覆盖率 ≥ 90%
- 关键发现识别完整
- 洞察质量评分 ≥ 8.0

### 内容生成验证
- 内容逻辑一致性检查通过
- 建议可操作性 ≥ 85%
- 表达清晰度评分 ≥ 8.5

### 格式转换验证
- 格式转换成功率 = 100%
- 视觉效果质量 ≥ 8.0
- 用户友好性评分 ≥ 8.0

### 质量保证验证
- 质量检查项目覆盖率 = 100%
- 内容准确性 ≥ 95%
- 交付标准符合率 = 100%

## 配置选项

### 工作流特定配置
- `flexible_objectives`: 是否启用灵活的任务目标
- `multi_format_output`: 是否启用多格式输出
- `data_preprocessing`: 是否启用数据预处理
- `iterative_refinement`: 是否启用迭代优化
- `template_customization`: 是否启用模板定制

### 步骤级配置
每个步骤都可以配置：
- `pause_for_approval`: 是否暂停等待审批
- `dod_check`: 是否执行DoD验证
- `timeout`: 步骤超时时间
- 特定步骤的配置参数

## 使用场景

### 1. 数据分析报告
- **目标**：分析业务数据，生成洞察报告
- **输入**：业务数据、历史记录、性能指标
- **输出**：分析报告（Excel + PPT）
- **复杂度**：中等

### 2. 流程优化方案
- **目标**：分析现有流程，提出优化建议
- **输入**：流程文档、问题反馈、效率数据
- **输出**：优化方案（Markdown + PPT）
- **复杂度**：高

### 3. 竞品分析研究
- **目标**：分析竞争对手，制定策略建议
- **输入**：竞品资料、市场数据、用户反馈
- **输出**：竞品分析报告（PDF + Excel）
- **复杂度**：高

### 4. 知识整理汇编
- **目标**：整理分散的知识，形成系统文档
- **输入**：各类文档、笔记、资料
- **输出**：知识手册（Markdown + PDF）
- **复杂度**：低

### 5. 技术方案评估
- **目标**：评估技术方案的可行性和风险
- **输入**：技术文档、需求规格、约束条件
- **输出**：评估报告（Markdown + PPT）
- **复杂度**：中等

## 产物输出

### 主要产物
- 任务目标表格
- 目标选择清单
- 预处理数据集
- 分析策略文档
- 分析结果报告
- 洞察发现文档
- 建议方案清单
- 结构化内容文档
- 多格式输出文件
- 质量审查报告
- 完整交付包
- 任务完成报告

### 产物命名
所有产物按照 `{task_id}/{timestamp}/{step_name}` 的格式命名，确保唯一性和可追溯性。

## 扩展和定制

### 任务类型扩展
- 可以添加新的任务目标类别
- 定义特定领域的分析方法
- 配置专用的输出模板

### 分析方法扩展
- 可以集成新的分析算法
- 添加特定的数据处理步骤
- 定制可视化图表类型

### 输出格式扩展
- 可以添加新的输出格式
- 定制特定的模板样式
- 配置个性化的品牌元素

### 质量标准定制
- 可以修改DoD验证规则
- 调整质量评分标准
- 定义特定的验收条件

## 最佳实践

### 1. 目标设定
- 明确具体的任务目标
- 设定可衡量的成功标准
- 考虑时间和资源约束
- 预留迭代优化空间

### 2. 数据准备
- 确保数据源的可靠性
- 进行充分的数据清洗
- 建立数据质量检查机制
- 保留原始数据备份

### 3. 分析策略
- 选择合适的分析方法
- 平衡分析深度和效率
- 考虑输出受众的需求
- 建立验证和校核机制

### 4. 质量控制
- 定期检查中间结果
- 进行多轮质量审查
- 收集用户反馈意见
- 持续优化流程标准

### 5. 交付管理
- 提前确认交付格式
- 建立版本控制机制
- 提供完整的使用说明
- 保留后续维护通道
